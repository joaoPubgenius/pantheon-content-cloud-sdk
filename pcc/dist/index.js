#!/usr/bin/env node
import Ge from 'yargs';
import { hideBin } from 'yargs/helpers';
import { exit, chdir } from 'process';
import { exec } from 'child_process';
import { Octokit } from 'octokit';
import { existsSync, rmSync, mkdirSync, writeFileSync, readdirSync, renameSync, cpSync, readFileSync } from 'fs';
import b, { dirname, join } from 'path';
import me from 'os';
import f from 'chalk';
import F from 'ora';
import h, { HttpStatusCode } from 'axios';
import { ensureFile } from 'fs-extra';
import { Console } from 'console';
import { Transform } from 'stream';
import Te from 'dayjs';
import { OAuth2Client } from 'google-auth-library';
import Ie from 'http';
import je, { fileURLToPath } from 'url';
import Re from 'open';
import Me from 'server-destroy';
import W from 'nunjucks';

var m=class extends Error{constructor(){super("Pleaes login user using `pcc login` command"),this.name=this.constructor.name;}},C=class extends Error{constructor(){super("Not Found"),this.name=this.constructor.name;}};function a(t){return async function(e){try{await t(e);}catch(o){o instanceof m?(console.log(f.red("Error: User is not logged in.")),console.log(f.yellow('Please run "pcc login" to login the user.'))):(console.log(f.yellow(`
Stack trace:`,o.stack)),console.log(f.red("Error: Something went wrong. Please contact Pantheon support team.")),exit(1));}}}var P=class{constructor(e,o=!1){o?this.logger=null:this.logger=F(e);}start(){this.logger&&this.logger.start();}stop(){this.logger&&this.logger.stop();}succeed(e){this.logger&&this.logger.succeed(e);}},_=class{constructor(e=!1){this.logger=console,this.disabled=e;}log(...e){this.disabled||this.logger.log(...e);}error(...e){this.logger.error(...e);}};var l=b.join(me.tmpdir(),"react_sdk_90723"),D="sdk-repo.tar",ge={nextjs:"nextjs-starter",gatsby:"gatsby-starter"},ue={eslint:"^8.24.0","eslint-config-next":"^13.1.1"},fe={extends:"next/core-web-vitals"},he=new Octokit;async function A(t){return new Promise(function(e,o){exec(t,(s,p,g)=>{s?o(s):e({stdout:p,stderr:g});});})}var ye=async({dirName:t,template:e,skipInstallation:o,packageManager:s,silentLogs:p,eslint:g,appName:d})=>{let r=new _(p);t||(r.error(f.red("ERROR: Please enter valid directory name. Check pcc init --help for more details.")),exit(1)),existsSync(l)&&rmSync(l,{recursive:!0}),mkdirSync(l);let n=new P("Fetching starter kit...",p);n.start();let{data:i}=await he.request("GET /repos/{owner}/{repo}/tarball",{owner:"pantheon-systems",repo:"pantheon-content-cloud-sdk"});writeFileSync(b.join(l,D),Buffer.from(i)),await A(`tar xvpf ${b.join(l,D)} -C ${l}`);let v=readdirSync(l);v=v.filter(k=>k!==D),renameSync(b.join(l,v[0]),b.join(l,"pantheon-sdk")),n.succeed("Fetched starter kit!");let x=new P("Setting up project...",p);x.start(),existsSync(t)&&(x.stop(),r.error(f.red("ERROR: Project directory already exists.")),exit(1)),cpSync(b.join(l,"pantheon-sdk",ge[e]),t,{recursive:!0}),chdir(t);let w=JSON.parse(readFileSync("./package.json").toString());d?w.name=d:w.name=b.parse(t).base,g&&(w.devDependencies={...w.devDependencies,...ue},writeFileSync("./.eslintrc.json",JSON.stringify(fe,null,2))),writeFileSync("./package.json",JSON.stringify(w,null,2)+`
`),await A("git init"),await A("git add ."),await A('git commit -m "Initial commit from Pantheon Content Cloud Toolkit."'),x.succeed("Completed setting up project!");let T=e==="gatsby"?".env.development":".env.local";if(await A(`cp .env.example ${T}`),!o){let k=new P("Installing dependencies...",p);k.start(),await A(`${s} install`),k.succeed("Installed dependencies!");}process.chdir("../"),rmSync(l,{recursive:!0}),r.log(),r.log(f.green(`To get started please replace the placeholders in ${T}`)),r.log(f.green(`   cd ${t}`)),r.log(f.green("   vim .env.local")),r.log(f.green("And then run the website")),e==="nextjs"?r.log(f.green("   yarn dev")):r.log(f.green("   yarn start"));},B=a(ye);var J=b.join(me.homedir(),".pcc");var O=`${J}/auth.json`,u=async()=>{let t;try{t=JSON.parse(readFileSync(O).toString());}catch{return null}if(t.expiry_date&&t.expiry_date>Date.now())return t;try{let e=await c.refreshToken(t.refresh_token);return N(e),e}catch{return null}},N=async t=>{await new Promise((e,o)=>ensureFile(O,s=>{s?o(s):e();})),writeFileSync(O,JSON.stringify(t,null,2));};var Pe="staging",Ae={production:{addOnApiEndpoint:"https://us-central1-pantheon-content-cloud.cloudfunctions.net/addOnApi",googleClientId:"432998952749-6eurouamlt7mvacb6u4e913m3kg4774c.apps.googleusercontent.com",googleRedirectUri:"http://localhost:3030/oauth-redirect"},staging:{addOnApiEndpoint:"https://us-central1-pantheon-content-cloud-staging.cloudfunctions.net/addOnApi",googleClientId:"142470191541-8o14j77pvagisc66s48kl4ub91f9c7b8.apps.googleusercontent.com",googleRedirectUri:"http://localhost:3030/oauth-redirect"}},S=Ae[Pe];var $=`${S.addOnApiEndpoint}/api-key`,R=`${S.addOnApiEndpoint}/sites`,z=`${S.addOnApiEndpoint}/oauth`,M=class{static async getToken(e){return (await h.post(`${z}/token`,{code:e})).data}static async refreshToken(e){return (await h.post(`${z}/refresh`,{refreshToken:e})).data}static async createApiKey(){let e=await u();if(!e)throw new m;return (await h.post($,{},{headers:{Authorization:`Bearer ${e.id_token}`}})).data.apiKey}static async listApiKeys(){let e=await u();if(!e)throw new m;return (await h.get($,{headers:{Authorization:`Bearer ${e.id_token}`}})).data}static async revokeApiKey(e){let o=await u();if(!o)throw new m;try{await h.delete(`${$}/${e}`,{headers:{Authorization:`Bearer ${o.id_token}`}});}catch(s){if(s.response.status===HttpStatusCode.NotFound)throw new C}}static async createSite(e){let o=await u();if(!o)throw new m;return (await h.post(R,{name:"",url:e,emailList:""},{headers:{Authorization:`Bearer ${o.id_token}`}})).data.id}static async listSites(){let e=await u();if(!e)throw new m;return (await h.get(R,{headers:{Authorization:`Bearer ${e.id_token}`}})).data}static async updateSite(e,o){let s=await u();if(!s)throw new m;await h.patch(`${R}/${e}`,{url:o},{headers:{Authorization:`Bearer ${s.id_token}`}});}},c=M;function I(t){if(t.length===0)return;let e=Object.keys(t[0]).reduce((r,n)=>(r[n]=n.toString().length,r),{});t.forEach(r=>{Object.keys(e).forEach(n=>{r[n].toString().length>e[n]&&(e[n]=r[n].toString().length);});});let o=[];t.forEach(r=>{o.push(Object.keys(e).reduce((n,i)=>(n[i]=r[i].toString().padEnd(e[i]),n),{}));});let s=new Transform({transform(r,n,i){i(null,r);}});new Console({stdout:s}).table(o);let g=(s.read()||"").toString(),d="";for(let r of g.split(/[\r\n]+/)){let n=r.replace(/[^┬]*┬/,"\u250C");n=n.replace(/^├─*┼/,"\u251C"),n=n.replace(/│[^│]*/,""),n=n.replace(/^└─*┴/,"\u2514"),n=n.replace(/'/g," "),d+=`${n}
`;}console.log(d);}var q=a(async()=>{let t=F("Creating token...").start();try{let e=await c.createApiKey();t.succeed("Successfully created token for your user. "),console.log(`
Token:`,f.bold(f.green(e)),`
`),console.log(f.bold(f.yellow("Please note it down. It wont be accessible hereafter.")));}catch(e){throw t.fail(),e}}),G=a(async()=>{let t=F("Fetching list of existing tokens...").start();try{let e=await c.listApiKeys();if(t.succeed("Successfully fetched list of tokens."),e.length===0){console.log(f.yellow("No tokens found."));return}I(e.map(o=>({Id:o.id,Key:o.keyMasked,"Created At":Te(o.created).format("DD MMM YYYY, hh:mm A")})));}catch(e){throw t.fail(),e}}),V=a(async t=>{let e=F("Revoking token for given ID...").start();try{await c.revokeApiKey(t),e.succeed(`Successfully revoked token for ID "${f.bold(f.yellow(t))}"!`);}catch(o){throw e.fail(),o instanceof C&&(console.log(f.red("Token for given ID not found.")),exit(1)),o}});function L(t){return JSON.parse(Buffer.from(t.split(".")[1],"base64").toString())}W.configure({autoescape:!0});var Le=["https://www.googleapis.com/auth/userinfo.email"];function He(){return new Promise(async(t,e)=>{let o=F("Logging you in...").start();try{let s=await u();if(s){let r=L(s.id_token);o.succeed(`You are already logged in as ${r.email}.`);return}let g=new OAuth2Client({clientId:S.googleClientId,redirectUri:S.googleRedirectUri}).generateAuthUrl({access_type:"offline",scope:Le}),d=Ie.createServer(async(r,n)=>{try{if(r.url.indexOf("/oauth-redirect")>-1){let v=new je.URL(r.url,"http://localhost:3030").searchParams.get("code"),x=dirname(fileURLToPath(import.meta.url)),w=readFileSync(join(x,"../templates/loginSuccess.html")),T=await c.getToken(v),k=L(T.id_token);await N(T),n.end(W.renderString(w.toString(),{email:k.email})),d.destroy(),o.succeed(`You are successfully logged in as ${k.email}`),t();}}catch(i){o.fail(),e(i);}}).listen(3030,()=>{Re(g,{wait:!0}).then(r=>r.kill());});Me(d);}catch(s){throw o.fail(),s}})}var Q=a(He);var Je=async()=>{let t=F("Logging you out...").start();try{existsSync(O)&&rmSync(O),t.succeed("Successfully logged you out from PPC client!");}catch(e){throw t.fail(),e}},X=a(Je);var Z=a(async t=>{let e=F("Creating site...").start();try{await c.createSite(t),e.succeed("Successfully created the site with given details.");}catch(o){throw e.fail(),o}}),ee=a(async({id:t,url:e})=>{let o=F("Updating site...").start();try{await c.updateSite(t,e),o.succeed("Successfully updated the site for given ID.");}catch(s){throw o.fail(),s}}),te=a(async()=>{let t=F("Fetching list of existing sites...").start();try{let e=await c.listSites();if(t.succeed("Successfully fetched list of sites."),e.length===0){console.log(f.yellow("No sites found."));return}I(e.map(o=>({Id:o.id,Url:o.url,"Created At":o.created?Te(o.created).format("DD MMM YYYY, hh:mm A"):"NA"})));}catch(e){throw t.fail(),e}});Ge(hideBin(process.argv)).scriptName("pcc").usage("$0 <cmd>").strictCommands().demandCommand().command("init <project_directory> [options]","Sets up project with required files.",t=>{t.positional("<project_directory>",{describe:"The project directory in which setup should be done.",demandOption:!0,type:"string"}).option("template",{describe:"Template from which files should be copied.",type:"string",choices:["nextjs","gatsby"],demandOption:!0}).option("appName",{describe:'"package.json" compatible name for the project.',type:"string",demandOption:!1}).option("noInstall",{describe:"Do not install any dependencies.",type:"boolean",default:!1,demandOption:!1}).option("use-npm",{describe:"Use NPM package manager for installing dependencies.",type:"boolean",default:!1,demandOption:!1}).option("use-pnpm",{describe:"Use PNPM package manager for installing dependencies.",type:"boolean",default:!1,demandOption:!1}).option("use-yarn",{describe:"Use Yarn package manager for installing dependencies.",type:"boolean",default:!0,demandOption:!1}).option("silent",{describe:"Skips all console output except for errors and return value from actions.",type:"boolean",default:!1,demandOption:!1}).option("eslint",{describe:"Initialize with eslint config.",type:"boolean",default:!1,demandOption:!1});},async t=>{let e=t.project_directory,o=t.template,s=t.noInstall,p=t["use-npm"],g=t["use-pnpm"],d=t.appName,r=t.silent,n=t.eslint,i;p?i="npm":g?i="pnpm":i="yarn",await B({dirName:e,template:o,skipInstallation:s,packageManager:i,appName:d,silentLogs:r,eslint:n});}).command("token <cmd> [options]","Enables you to manage tokens for a PCC project.",t=>{t.strictCommands().demandCommand().command("create","Creates new token.",e=>{},async e=>await q()).command("list","Lists existing tokens.",e=>{},async e=>await G()).command("revoke <id>","Revokes token for a given id.",e=>{e.positional("<id>",{describe:"ID of the token which you want to revoke",demandOption:!0,type:"string"});},async e=>await V(e.id));},async t=>{}).command("site <cmd> [options]","Enables you to manage sites for a PCC project.",t=>{t.strictCommands().demandCommand().command("create [options]","Creates new site.",e=>{e.option("url",{describe:"Site url",type:"string",demandOption:!0});},async e=>await Z(e.url)).command("list","Lists existing sites.",e=>{},async e=>await te()).command("update <id> [options]","Updates site for a given ID.",e=>{e.positional("<id>",{describe:"ID of the site which you want to update",demandOption:!0,type:"string"}).option("url",{describe:"Site url",type:"string"});},async e=>await ee({id:e.id,url:e.url}));},async t=>{}).command("login","Logs you in you to PCC client.",t=>{},async t=>await Q()).command("logout","Logs you out you from PCC client.",t=>{},async t=>await X()).help(!0).argv;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jbGkvaW5kZXgudHMiLCIuLi9zcmMvY2xpL2NvbW1hbmRzL2luaXQudHMiLCIuLi9zcmMvY2xpL2V4Y2VwdGlvbnMudHMiLCIuLi9zcmMvbGliL2xvZ2dlci50cyIsIi4uL3NyYy9jbGkvY29tbWFuZHMvdG9rZW4udHMiLCIuLi9zcmMvbGliL2FkZG9uQXBpSGVscGVyLnRzIiwiLi4vc3JjL2xpYi9sb2NhbFN0b3JhZ2UudHMiLCIuLi9zcmMvY29uc3RhbnRzLnRzIiwiLi4vc3JjL2xpYi9jb25maWcudHMiLCIuLi9zcmMvbGliL2NsaURpc3BsYXkudHMiLCIuLi9zcmMvY2xpL2NvbW1hbmRzL2xvZ2luLnRzIiwiLi4vc3JjL2xpYi9qd3QudHMiLCIuLi9zcmMvY2xpL2NvbW1hbmRzL2xvZ291dC50cyIsIi4uL3NyYy9jbGkvY29tbWFuZHMvc2l0ZXMudHMiXSwibmFtZXMiOlsieWFyZ3MiLCJoaWRlQmluIiwiY2hkaXIiLCJleGl0IiwiZXhlYyIsIk9jdG9raXQiLCJleGlzdHNTeW5jIiwicm1TeW5jIiwibWtkaXJTeW5jIiwid3JpdGVGaWxlU3luYyIsInJlYWRGaWxlU3luYyIsInJlbmFtZVN5bmMiLCJyZWFkZGlyU3luYyIsImNwU3luYyIsInBhdGgiLCJvcyIsImNoYWxrIiwiVXNlck5vdExvZ2dlZEluIiwiSFRUUE5vdEZvdW5kIiwiZXJyb3JIYW5kbGVyIiwiZiIsImFyZyIsImUiLCJvcmEiLCJTcGlubmVyTG9nZ2VyIiwibWVzc2FnZSIsImRpc2FibGVkIiwiTG9nZ2VyIiwiYXJncyIsIlRFTVBfRElSX05BTUUiLCJUQVJfRklMRV9OQU1FIiwiVEVNUExBVEVfRk9MREVSX01BUCIsIkVTTElOVF9ERVBFTkRFTkNJRVMiLCJFU0xJTlRfQ09ORklHIiwib2N0b2tpdCIsInNoIiwiY21kIiwicmVzb2x2ZSIsInJlamVjdCIsImVyciIsInN0ZG91dCIsInN0ZGVyciIsImluaXQiLCJkaXJOYW1lIiwidGVtcGxhdGUiLCJza2lwSW5zdGFsbGF0aW9uIiwicGFja2FnZU1hbmFnZXIiLCJzaWxlbnRMb2dzIiwiZXNsaW50IiwiYXBwTmFtZSIsImxvZ2dlciIsImZldGNoU3RhcnRlciIsImRhdGEiLCJmaWxlcyIsIml0ZW0iLCJzZXR1cFByb2oiLCJwYWNrYWdlSnNvbiIsImxvY2FsRW52RmlsZU5hbWUiLCJpbnN0YWxsUHJvaiIsImluaXRfZGVmYXVsdCIsImF4aW9zIiwiSHR0cFN0YXR1c0NvZGUiLCJlbnN1cmVGaWxlIiwiUENDX1JPT1RfRElSIiwiQVVUSF9GSUxFX1BBVEgiLCJnZXRMb2NhbEF1dGhEZXRhaWxzIiwiY3JlZGVudGlhbHMiLCJuZXdDcmVkIiwiYWRkb25BcGlIZWxwZXJfZGVmYXVsdCIsInBlcnNpc3RBdXRoRGV0YWlscyIsInBheWxvYWQiLCJFTlYiLCJjb25maWciLCJjb25maWdfZGVmYXVsdCIsIkFQSV9LRVlfRU5EUE9JTlQiLCJTSVRFX0VORFBPSU5UIiwiT0FVVEhfRU5EUE9JTlQiLCJBZGRPbkFwaUhlbHBlciIsImNvZGUiLCJyZWZyZXNoVG9rZW4iLCJhdXRoRGV0YWlscyIsImlkIiwidXJsIiwiQ29uc29sZSIsIlRyYW5zZm9ybSIsInByaW50VGFibGUiLCJpbnB1dCIsImNvbHVtblBhZGRpbmdzIiwicHJldiIsImN1cnIiLCJyb3ciLCJjb2x1bW4iLCJpbnB1dFdpdGhQYWRkaW5ncyIsInRzIiwiY2h1bmsiLCJlbmMiLCJjYiIsInRhYmxlIiwicmVzdWx0IiwiciIsImRheWpzIiwiY3JlYXRlVG9rZW4iLCJzcGlubmVyIiwiYXBpS2V5IiwibGlzdFRva2VucyIsImFwaUtleXMiLCJyZXZva2VUb2tlbiIsIk9BdXRoMkNsaWVudCIsImh0dHAiLCJmaWxlVVJMVG9QYXRoIiwiZGlybmFtZSIsImpvaW4iLCJvcGVuIiwiZGVzdHJveWVyIiwibnVuanVja3MiLCJwYXJzZUp3dCIsInRva2VuIiwiT0FVVEhfU0NPUEVTIiwibG9naW4iLCJhdXRoRGF0YSIsImp3dFBheWxvYWQiLCJhdXRob3JpemVVcmwiLCJzZXJ2ZXIiLCJyZXEiLCJyZXMiLCJjdXJyRGlyIiwiY29udGVudCIsImNwIiwibG9naW5fZGVmYXVsdCIsImxvZ291dCIsImxvZ291dF9kZWZhdWx0IiwiY3JlYXRlU2l0ZSIsInVwZGF0ZVNpdGUiLCJsaXN0U2l0ZXMiLCJzaXRlcyIsIm5vSW5zdGFsbCIsInVzZU5wbSIsInVzZVBucG0iLCJzaWxlbnQiXSwibWFwcGluZ3MiOiI7QUFFQSxPQUFPQSxPQUFXLFFBQ2xCLE9BQVMsV0FBQUMsT0FBZSxnQkNIeEIsT0FBUyxTQUFBQyxHQUFPLFFBQUFDLE1BQVksVUFDNUIsT0FBUyxRQUFBQyxPQUFZLGdCQUNyQixPQUFTLFdBQUFDLE9BQWUsVUFDeEIsT0FDRSxjQUFBQyxFQUNBLFVBQUFDLEVBQ0EsYUFBQUMsR0FDQSxpQkFBQUMsRUFDQSxnQkFBQUMsR0FDQSxjQUFBQyxHQUNBLGVBQUFDLEdBQ0EsVUFBQUMsT0FDSyxLQUVQLE9BQU9DLE1BQVUsT0FDakIsT0FBT0MsT0FBUSxLQUNmLE9BQU9DLE1BQVcsUUNoQmxCLE9BQU9BLE1BQVcsUUFDbEIsT0FBUyxRQUFBYixPQUFZLFVBU2QsSUFBTWMsRUFBTixjQUE4QixLQUFNLENBQ3pDLGFBQWMsQ0FDWixNQUFNLDZDQUE2QyxFQUNuRCxLQUFLLEtBQU8sS0FBSyxZQUFZLElBQy9CLENBQ0YsRUFDYUMsRUFBTixjQUEyQixLQUFNLENBQ3RDLGFBQWMsQ0FDWixNQUFNLFdBQVcsRUFDakIsS0FBSyxLQUFPLEtBQUssWUFBWSxJQUMvQixDQUNGLEVBQ08sU0FBU0MsRUFBZ0JDLEVBQThCLENBQzVELE9BQU8sZUFBZ0JDLEVBQVEsQ0FDN0IsR0FBSSxDQUNGLE1BQU1ELEVBQUVDLENBQUcsQ0FDYixPQUFTQyxFQUFHLENBQ05BLGFBQWFMLEdBQ2YsUUFBUSxJQUFJRCxFQUFNLElBQUksK0JBQStCLENBQUMsRUFDdEQsUUFBUSxJQUFJQSxFQUFNLE9BQU8sMkNBQTJDLENBQUMsSUFFckUsUUFBUSxJQUNOQSxFQUFNLE9BQU87QUFBQSxjQUFtQk0sRUFBd0IsS0FB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QU0sUUFDUixDQUFDLENBQ0gsRUFDQSxNQUFPNEIsR0FBUyxNQUFNOEUsRUFBWTlFLEVBQUssRUFBWSxDQUNyRCxDQUNKLEVBQ0EsTUFBT0EsR0FBUyxDQUFDLENBQ25CLEVBQ0MsUUFDQyx1QkFDQSxpREFDQzVCLEdBQVUsQ0FDVEEsRUFDRyxlQUFlLEVBQ2YsY0FBYyxFQUNkLFFBQ0MsbUJBQ0Esb0JBQ0NBLEdBQVUsQ0FDVEEsRUFBTSxPQUFPLE1BQU8sQ0FDbEIsU0FBVSxXQUNWLEtBQU0sU0FDTixhQUFjLEVBQ2hCLENBQUMsQ0FDSCxFQUNBLE1BQU80QixHQUFTLE1BQU11RyxFQUFXdkcsRUFBSyxHQUFhLENBQ3JELEVBQ0MsUUFDQyxPQUNBLHdCQUNDNUIsR0FBVSxDQUFDLEVBQ1osTUFBTzRCLEdBQVMsTUFBTXlHLEdBQVUsQ0FDbEMsRUFDQyxRQUNDLHdCQUNBLCtCQUNDckksR0FBVSxDQUNUQSxFQUNHLFdBQVcsT0FBUSxDQUNsQixTQUFVLDBDQUNWLGFBQWMsR0FDZCxLQUFNLFFBQ1IsQ0FBQyxFQUNBLE9BQU8sTUFBTyxDQUNiLFNBQVUsV0FDVixLQUFNLFFBQ1IsQ0FBQyxDQUNMLEVBQ0EsTUFBTzRCLEdBQ0wsTUFBTXdHLEdBQVcsQ0FDZixHQUFJeEcsRUFBSyxHQUNULElBQUtBLEVBQUssR0FDWixDQUFDLENBQ0wsQ0FDSixFQUNBLE1BQU9BLEdBQVMsQ0FBQyxDQUNuQixFQUNDLFFBQ0MsUUFDQSxpQ0FDQzVCLEdBQVUsQ0FBQyxFQUNaLE1BQU80QixHQUFTLE1BQU1vRyxFQUFNLENBQzlCLEVBQ0MsUUFDQyxTQUNBLG9DQUNDaEksR0FBVSxDQUFDLEVBQ1osTUFBTzRCLEdBQVMsTUFBTXNHLEVBQU8sQ0FDL0IsRUFDQyxLQUFLLEVBQUksRUFBRSIsInNvdXJjZXNDb250ZW50IjpbIiMhL3Vzci9iaW4vZW52IG5vZGVcbmltcG9ydCB7IGV4aXQgfSBmcm9tICdwcm9jZXNzJztcbmltcG9ydCB5YXJncyBmcm9tICd5YXJncyc7XG5pbXBvcnQgeyBoaWRlQmluIH0gZnJvbSAneWFyZ3MvaGVscGVycyc7XG5pbXBvcnQgaW5pdCBmcm9tICcuL2NvbW1hbmRzL2luaXQnO1xuaW1wb3J0IHsgY3JlYXRlVG9rZW4sIGxpc3RUb2tlbnMsIHJldm9rZVRva2VuIH0gZnJvbSAnLi9jb21tYW5kcy90b2tlbic7XG5pbXBvcnQgbG9naW4gZnJvbSAnLi9jb21tYW5kcy9sb2dpbic7XG5pbXBvcnQgbG9nb3V0IGZyb20gJy4vY29tbWFuZHMvbG9nb3V0JztcbmltcG9ydCB7IGNyZWF0ZVNpdGUsIGxpc3RTaXRlcywgdXBkYXRlU2l0ZSB9IGZyb20gJy4vY29tbWFuZHMvc2l0ZXMnO1xuXG55YXJncyhoaWRlQmluKHByb2Nlc3MuYXJndikpXG4gIC5zY3JpcHROYW1lKCdwY2MnKVxuICAudXNhZ2UoJyQwIDxjbWQ+JylcbiAgLnN0cmljdENvbW1hbmRzKClcbiAgLmRlbWFuZENvbW1hbmQoKVxuICAuY29tbWFuZChcbiAgICAnaW5pdCA8cHJvamVjdF9kaXJlY3Rvcnk+IFtvcHRpb25zXScsXG4gICAgJ1NldHMgdXAgcHJvamVjdCB3aXRoIHJlcXVpcmVkIGZpbGVzLicsXG4gICAgKHlhcmdzKSA9PiB7XG4gICAgICB5YXJnc1xuICAgICAgICAucG9zaXRpb25hbCgnPHByb2plY3RfZGlyZWN0b3J5PicsIHtcbiAgICAgICAgICBkZXNjcmliZTogJ1RoZSBwcm9qZWN0IGRpcmVjdG9yeSBpbiB3aGljaCBzZXR1cCBzaG91bGQgYmUgZG9uZS4nLFxuICAgICAgICAgIGRlbWFuZE9wdGlvbjogdHJ1ZSxcbiAgICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgfSlcbiAgICAgICAgLm9wdGlvbigndGVtcGxhdGUnLCB7XG4gICAgICAgICAgZGVzY3JpYmU6ICdUZW1wbGF0ZSBmcm9tIHdoaWNoIGZpbGVzIHNob3VsZCBiZSBjb3BpZWQuJyxcbiAgICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgICBjaG9pY2VzOiBbJ25leHRqcycsICdnYXRzYnknXSxcbiAgICAgICAgICBkZW1hbmRPcHRpb246IHRydWUsXG4gICAgICAgIH0pXG4gICAgICAgIC5vcHRpb24oJ2FwcE5hbWUnLCB7XG4gICAgICAgICAgZGVzY3JpYmU6ICdcInBhY2thZ2UuanNvblwiIGNvbXBhdGlibGUgbmFtZSBmb3IgdGhlIHByb2plY3QuJyxcbiAgICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgICBkZW1hbmRPcHRpb246IGZhbHNlLFxuICAgICAgICB9KVxuICAgICAgICAub3B0aW9uKCdub0luc3RhbGwnLCB7XG4gICAgICAgICAgZGVzY3JpYmU6ICdEbyBub3QgaW5zdGFsbCBhbnkgZGVwZW5kZW5jaWVzLicsXG4gICAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxuICAgICAgICAgIGRlbWFuZE9wdGlvbjogZmFsc2UsXG4gICAgICAgIH0pXG4gICAgICAgIC5vcHRpb24oJ3VzZS1ucG0nLCB7XG4gICAgICAgICAgZGVzY3JpYmU6ICdVc2UgTlBNIHBhY2thZ2UgbWFuYWdlciBmb3IgaW5zdGFsbGluZyBkZXBlbmRlbmNpZXMuJyxcbiAgICAgICAgICB0eXBlOiAnYm9vbGVhbicsXG4gICAgICAgICAgZGVmYXVsdDogZmFsc2UsXG4gICAgICAgICAgZGVtYW5kT3B0aW9uOiBmYWxzZSxcbiAgICAgICAgfSlcbiAgICAgICAgLm9wdGlvbigndXNlLXBucG0nLCB7XG4gICAgICAgICAgZGVzY3JpYmU6ICdVc2UgUE5QTSBwYWNrYWdlIG1hbmFnZXIgZm9yIGluc3RhbGxpbmcgZGVwZW5kZW5jaWVzLicsXG4gICAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxuICAgICAgICAgIGRlbWFuZE9wdGlvbjogZmFsc2UsXG4gICAgICAgIH0pXG4gICAgICAgIC5vcHRpb24oJ3VzZS15YXJuJywge1xuICAgICAgICAgIGRlc2NyaWJlOiAnVXNlIFlhcm4gcGFja2FnZSBtYW5hZ2VyIGZvciBpbnN0YWxsaW5nIGRlcGVuZGVuY2llcy4nLFxuICAgICAgICAgIHR5cGU6ICdib29sZWFuJyxcbiAgICAgICAgICBkZWZhdWx0OiB0cnVlLFxuICAgICAgICAgIGRlbWFuZE9wdGlvbjogZmFsc2UsXG4gICAgICAgIH0pXG4gICAgICAgIC5vcHRpb24oJ3NpbGVudCcsIHtcbiAgICAgICAgICBkZXNjcmliZTpcbiAgICAgICAgICAgICdTa2lwcyBhbGwgY29uc29sZSBvdXRwdXQgZXhjZXB0IGZvciBlcnJvcnMgYW5kIHJldHVybiB2YWx1ZSBmcm9tIGFjdGlvbnMuJyxcbiAgICAgICAgICB0eXBlOiAnYm9vbGVhbicsXG4gICAgICAgICAgZGVmYXVsdDogZmFsc2UsXG4gICAgICAgICAgZGVtYW5kT3B0aW9uOiBmYWxzZSxcbiAgICAgICAgfSlcbiAgICAgICAgLm9wdGlvbignZXNsaW50Jywge1xuICAgICAgICAgIGRlc2NyaWJlOiAnSW5pdGlhbGl6ZSB3aXRoIGVzbGludCBjb25maWcuJyxcbiAgICAgICAgICB0eXBlOiAnYm9vbGVhbicsXG4gICAgICAgICAgZGVmYXVsdDogZmFsc2UsXG4gICAgICAgICAgZGVtYW5kT3B0aW9uOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyAoYXJncykgPT4ge1xuICAgICAgY29uc3QgZGlyTmFtZSA9IGFyZ3MucHJvamVjdF9kaXJlY3RvcnkgYXMgc3RyaW5nO1xuICAgICAgY29uc3QgdGVtcGxhdGUgPSBhcmdzLnRlbXBsYXRlIGFzIENsaVRlbXBsYXRlT3B0aW9ucztcbiAgICAgIGNvbnN0IG5vSW5zdGFsbCA9IGFyZ3Mubm9JbnN0YWxsIGFzIGJvb2xlYW47XG4gICAgICBjb25zdCB1c2VOcG0gPSBhcmdzWyd1c2UtbnBtJ10gYXMgYm9vbGVhbjtcbiAgICAgIGNvbnN0IHVzZVBucG0gPSBhcmdzWyd1c2UtcG5wbSddIGFzIGJvb2xlYW47XG4gICAgICBjb25zdCBhcHBOYW1lID0gYXJncy5hcHBOYW1lIGFzIHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICAgIGNvbnN0IHNpbGVudCA9IGFyZ3Muc2lsZW50IGFzIGJvb2xlYW47XG4gICAgICBjb25zdCBlc2xpbnQgPSBhcmdzLmVzbGludCBhcyBib29sZWFuO1xuXG4gICAgICAvLyBEZXJpdmluZyBwYWNrYWdlIG1hbmFnZXIgZnJvbSBDTEkgZmxhZ3MgaW4gW05QTSwgUE5QTSwgWWFybl0gb3JkZXJcbiAgICAgIGxldCBwYWNrYWdlTWFuYWdlcjogUGFja2FnZU1hbmFnZXI7XG4gICAgICBpZiAodXNlTnBtKSBwYWNrYWdlTWFuYWdlciA9ICducG0nO1xuICAgICAgZWxzZSBpZiAodXNlUG5wbSkgcGFja2FnZU1hbmFnZXIgPSAncG5wbSc7XG4gICAgICBlbHNlIHBhY2thZ2VNYW5hZ2VyID0gJ3lhcm4nO1xuXG4gICAgICBhd2FpdCBpbml0KHtcbiAgICAgICAgZGlyTmFtZSxcbiAgICAgICAgdGVtcGxhdGUsXG4gICAgICAgIHNraXBJbnN0YWxsYXRpb246IG5vSW5zdGFsbCxcbiAgICAgICAgcGFja2FnZU1hbmFnZXIsXG4gICAgICAgIGFwcE5hbWUsXG4gICAgICAgIHNpbGVudExvZ3M6IHNpbGVudCxcbiAgICAgICAgZXNsaW50XG4gICAgICB9KTtcbiAgICB9LFxuICApXG4gIC5jb21tYW5kKFxuICAgICd0b2tlbiA8Y21kPiBbb3B0aW9uc10nLFxuICAgICdFbmFibGVzIHlvdSB0byBtYW5hZ2UgdG9rZW5zIGZvciBhIFBDQyBwcm9qZWN0LicsXG4gICAgKHlhcmdzKSA9PiB7XG4gICAgICB5YXJnc1xuICAgICAgICAuc3RyaWN0Q29tbWFuZHMoKVxuICAgICAgICAuZGVtYW5kQ29tbWFuZCgpXG4gICAgICAgIC5jb21tYW5kKFxuICAgICAgICAgICdjcmVhdGUnLFxuICAgICAgICAgICdDcmVhdGVzIG5ldyB0b2tlbi4nLFxuICAgICAgICAgICh5YXJncykgPT4ge30sXG4gICAgICAgICAgYXN5bmMgKGFyZ3MpID0+IGF3YWl0IGNyZWF0ZVRva2VuKCksXG4gICAgICAgIClcbiAgICAgICAgLmNvbW1hbmQoXG4gICAgICAgICAgJ2xpc3QnLFxuICAgICAgICAgICdMaXN0cyBleGlzdGluZyB0b2tlbnMuJyxcbiAgICAgICAgICAoeWFyZ3MpID0+IHt9LFxuICAgICAgICAgIGFzeW5jIChhcmdzKSA9PiBhd2FpdCBsaXN0VG9rZW5zKCksXG4gICAgICAgIClcbiAgICAgICAgLmNvbW1hbmQoXG4gICAgICAgICAgJ3Jldm9rZSA8aWQ+JyxcbiAgICAgICAgICAnUmV2b2tlcyB0b2tlbiBmb3IgYSBnaXZlbiBpZC4nLFxuICAgICAgICAgICh5YXJncykgPT4ge1xuICAgICAgICAgICAgeWFyZ3MucG9zaXRpb25hbCgnPGlkPicsIHtcbiAgICAgICAgICAgICAgZGVzY3JpYmU6ICdJRCBvZiB0aGUgdG9rZW4gd2hpY2ggeW91IHdhbnQgdG8gcmV2b2tlJyxcbiAgICAgICAgICAgICAgZGVtYW5kT3B0aW9uOiB0cnVlLFxuICAgICAgICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYXN5bmMgKGFyZ3MpID0+IGF3YWl0IHJldm9rZVRva2VuKGFyZ3MuaWQgYXMgc3RyaW5nKSxcbiAgICAgICAgKTtcbiAgICB9LFxuICAgIGFzeW5jIChhcmdzKSA9PiB7fSxcbiAgKVxuICAuY29tbWFuZChcbiAgICAnc2l0ZSA8Y21kPiBbb3B0aW9uc10nLFxuICAgICdFbmFibGVzIHlvdSB0byBtYW5hZ2Ugc2l0ZXMgZm9yIGEgUENDIHByb2plY3QuJyxcbiAgICAoeWFyZ3MpID0+IHtcbiAgICAgIHlhcmdzXG4gICAgICAgIC5zdHJpY3RDb21tYW5kcygpXG4gICAgICAgIC5kZW1hbmRDb21tYW5kKClcbiAgICAgICAgLmNvbW1hbmQoXG4gICAgICAgICAgJ2NyZWF0ZSBbb3B0aW9uc10nLFxuICAgICAgICAgICdDcmVhdGVzIG5ldyBzaXRlLicsXG4gICAgICAgICAgKHlhcmdzKSA9PiB7XG4gICAgICAgICAgICB5YXJncy5vcHRpb24oJ3VybCcsIHtcbiAgICAgICAgICAgICAgZGVzY3JpYmU6ICdTaXRlIHVybCcsXG4gICAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgICBkZW1hbmRPcHRpb246IHRydWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFzeW5jIChhcmdzKSA9PiBhd2FpdCBjcmVhdGVTaXRlKGFyZ3MudXJsIGFzIHN0cmluZyksXG4gICAgICAgIClcbiAgICAgICAgLmNvbW1hbmQoXG4gICAgICAgICAgJ2xpc3QnLFxuICAgICAgICAgICdMaXN0cyBleGlzdGluZyBzaXRlcy4nLFxuICAgICAgICAgICh5YXJncykgPT4ge30sXG4gICAgICAgICAgYXN5bmMgKGFyZ3MpID0+IGF3YWl0IGxpc3RTaXRlcygpLFxuICAgICAgICApXG4gICAgICAgIC5jb21tYW5kKFxuICAgICAgICAgICd1cGRhdGUgPGlkPiBbb3B0aW9uc10nLFxuICAgICAgICAgICdVcGRhdGVzIHNpdGUgZm9yIGEgZ2l2ZW4gSUQuJyxcbiAgICAgICAgICAoeWFyZ3MpID0+IHtcbiAgICAgICAgICAgIHlhcmdzXG4gICAgICAgICAgICAgIC5wb3NpdGlvbmFsKCc8aWQ+Jywge1xuICAgICAgICAgICAgICAgIGRlc2NyaWJlOiAnSUQgb2YgdGhlIHNpdGUgd2hpY2ggeW91IHdhbnQgdG8gdXBkYXRlJyxcbiAgICAgICAgICAgICAgICBkZW1hbmRPcHRpb246IHRydWUsXG4gICAgICAgICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC5vcHRpb24oJ3VybCcsIHtcbiAgICAgICAgICAgICAgICBkZXNjcmliZTogJ1NpdGUgdXJsJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBhc3luYyAoYXJncykgPT5cbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVNpdGUoe1xuICAgICAgICAgICAgICBpZDogYXJncy5pZCBhcyBzdHJpbmcsXG4gICAgICAgICAgICAgIHVybDogYXJncy51cmwgYXMgc3RyaW5nLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICk7XG4gICAgfSxcbiAgICBhc3luYyAoYXJncykgPT4ge30sXG4gIClcbiAgLmNvbW1hbmQoXG4gICAgJ2xvZ2luJyxcbiAgICAnTG9ncyB5b3UgaW4geW91IHRvIFBDQyBjbGllbnQuJyxcbiAgICAoeWFyZ3MpID0+IHt9LFxuICAgIGFzeW5jIChhcmdzKSA9PiBhd2FpdCBsb2dpbigpLFxuICApXG4gIC5jb21tYW5kKFxuICAgICdsb2dvdXQnLFxuICAgICdMb2dzIHlvdSBvdXQgeW91IGZyb20gUENDIGNsaWVudC4nLFxuICAgICh5YXJncykgPT4ge30sXG4gICAgYXN5bmMgKGFyZ3MpID0+IGF3YWl0IGxvZ291dCgpLFxuICApXG4gIC5oZWxwKHRydWUpLmFyZ3Y7XG4iLCJpbXBvcnQgeyBjaGRpciwgZXhpdCB9IGZyb20gJ3Byb2Nlc3MnO1xuaW1wb3J0IHsgZXhlYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0IHsgT2N0b2tpdCB9IGZyb20gJ29jdG9raXQnO1xuaW1wb3J0IHtcbiAgZXhpc3RzU3luYyxcbiAgcm1TeW5jLFxuICBta2RpclN5bmMsXG4gIHdyaXRlRmlsZVN5bmMsXG4gIHJlYWRGaWxlU3luYyxcbiAgcmVuYW1lU3luYyxcbiAgcmVhZGRpclN5bmMsXG4gIGNwU3luYyxcbn0gZnJvbSAnZnMnO1xuaW1wb3J0IG9yYSBmcm9tICdvcmEnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgb3MgZnJvbSAnb3MnO1xuaW1wb3J0IGNoYWxrIGZyb20gJ2NoYWxrJztcbmltcG9ydCB7IGVycm9ySGFuZGxlciB9IGZyb20gJy4uL2V4Y2VwdGlvbnMnO1xuaW1wb3J0IHsgTG9nZ2VyLCBTcGlubmVyTG9nZ2VyIH0gZnJvbSAnLi4vLi4vbGliL2xvZ2dlcic7XG5jb25zdCBURU1QX0RJUl9OQU1FID0gcGF0aC5qb2luKG9zLnRtcGRpcigpLCAncmVhY3Rfc2RrXzkwNzIzJyk7XG5jb25zdCBUQVJfRklMRV9OQU1FID0gJ3Nkay1yZXBvLnRhcic7XG5jb25zdCBURU1QTEFURV9GT0xERVJfTUFQID0ge1xuICBuZXh0anM6ICduZXh0anMtc3RhcnRlcicsXG4gIGdhdHNieTogJ2dhdHNieS1zdGFydGVyJyxcbn07XG5cbi8vIFRPRE86IE1ha2Ugc3VyZSBiZWxvdyBFU0xJTlQgdmVyc2lvbnMgYXJlIG5vdCBzdGFsZS5cbmNvbnN0IEVTTElOVF9ERVBFTkRFTkNJRVMgPSB7XG4gIGVzbGludDogJ144LjI0LjAnLFxuICAnZXNsaW50LWNvbmZpZy1uZXh0JzogJ14xMy4xLjEnLFxufTtcblxuY29uc3QgRVNMSU5UX0NPTkZJRyA9IHtcbiAgZXh0ZW5kczogJ25leHQvY29yZS13ZWItdml0YWxzJyxcbn07XG5cbmNvbnN0IG9jdG9raXQgPSBuZXcgT2N0b2tpdCgpO1xuYXN5bmMgZnVuY3Rpb24gc2goY21kOiBzdHJpbmcpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICBleGVjKGNtZCwgKGVyciwgc3Rkb3V0LCBzdGRlcnIpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHsgc3Rkb3V0LCBzdGRlcnIgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufVxuLyoqXG4gKiBIYW5kbGVzIGluaXRpYWxpemluZyBwcm9qZWN0cyBmb3IgUENDXG4gKi9cbmNvbnN0IGluaXQgPSBhc3luYyAoe1xuICBkaXJOYW1lLFxuICB0ZW1wbGF0ZSxcbiAgc2tpcEluc3RhbGxhdGlvbixcbiAgcGFja2FnZU1hbmFnZXIsXG4gIHNpbGVudExvZ3MsXG4gIGVzbGludCxcbiAgYXBwTmFtZSxcbn06IHtcbiAgZGlyTmFtZTogc3RyaW5nO1xuICB0ZW1wbGF0ZTogQ2xpVGVtcGxhdGVPcHRpb25zO1xuICBza2lwSW5zdGFsbGF0aW9uOiBib29sZWFuO1xuICBwYWNrYWdlTWFuYWdlcjogUGFja2FnZU1hbmFnZXI7XG4gIHNpbGVudExvZ3M6IGJvb2xlYW47XG4gIGVzbGludDogYm9vbGVhbjtcbiAgYXBwTmFtZT86IHN0cmluZztcbn0pID0+IHtcbiAgY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcihzaWxlbnRMb2dzKTtcbiAgaWYgKCFkaXJOYW1lKSB7XG4gICAgbG9nZ2VyLmVycm9yKFxuICAgICAgY2hhbGsucmVkKFxuICAgICAgICAnRVJST1I6IFBsZWFzZSBlbnRlciB2YWxpZCBkaXJlY3RvcnkgbmFtZS4gQ2hlY2sgcGNjIGluaXQgLS1oZWxwIGZvciBtb3JlIGRldGFpbHMuJyxcbiAgICAgICksXG4gICAgKTtcbiAgICBleGl0KDEpO1xuICB9XG5cbiAgaWYgKGV4aXN0c1N5bmMoVEVNUF9ESVJfTkFNRSkpIHJtU3luYyhURU1QX0RJUl9OQU1FLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgbWtkaXJTeW5jKFRFTVBfRElSX05BTUUpO1xuXG4gIC8vIENsb25pbmcgc3RhcnRlciBraXQgbG9jYWxseVxuICBjb25zdCBmZXRjaFN0YXJ0ZXIgPSBuZXcgU3Bpbm5lckxvZ2dlcignRmV0Y2hpbmcgc3RhcnRlciBraXQuLi4nLCBzaWxlbnRMb2dzKTtcbiAgZmV0Y2hTdGFydGVyLnN0YXJ0KCk7XG4gIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgb2N0b2tpdC5yZXF1ZXN0KCdHRVQgL3JlcG9zL3tvd25lcn0ve3JlcG99L3RhcmJhbGwnLCB7XG4gICAgb3duZXI6ICdwYW50aGVvbi1zeXN0ZW1zJyxcbiAgICByZXBvOiAncGFudGhlb24tY29udGVudC1jbG91ZC1zZGsnLFxuICB9KTtcbiAgd3JpdGVGaWxlU3luYyhwYXRoLmpvaW4oVEVNUF9ESVJfTkFNRSwgVEFSX0ZJTEVfTkFNRSksIEJ1ZmZlci5mcm9tKGRhdGEpKTtcbiAgYXdhaXQgc2goXG4gICAgYHRhciB4dnBmICR7cGF0aC5qb2luKFRFTVBfRElSX05BTUUsIFRBUl9GSUxFX05BTUUpfSAtQyAke1RFTVBfRElSX05BTUV9YCxcbiAgKTtcbiAgbGV0IGZpbGVzID0gcmVhZGRpclN5bmMoVEVNUF9ESVJfTkFNRSk7XG4gIGZpbGVzID0gZmlsZXMuZmlsdGVyKChpdGVtKSA9PiBpdGVtICE9PSBUQVJfRklMRV9OQU1FKTtcbiAgcmVuYW1lU3luYyhcbiAgICBwYXRoLmpvaW4oVEVNUF9ESVJfTkFNRSwgZmlsZXNbMF0pLFxuICAgIHBhdGguam9pbihURU1QX0RJUl9OQU1FLCAncGFudGhlb24tc2RrJyksXG4gICk7XG4gIGZldGNoU3RhcnRlci5zdWNjZWVkKCdGZXRjaGVkIHN0YXJ0ZXIga2l0IScpO1xuXG4gIC8vIFNldHRpbmcgdXAgbmV3IHByb2plY3RcbiAgY29uc3Qgc2V0dXBQcm9qID0gbmV3IFNwaW5uZXJMb2dnZXIoJ1NldHRpbmcgdXAgcHJvamVjdC4uLicsIHNpbGVudExvZ3MpO1xuICBzZXR1cFByb2ouc3RhcnQoKTtcbiAgaWYgKGV4aXN0c1N5bmMoZGlyTmFtZSkpIHtcbiAgICBzZXR1cFByb2ouc3RvcCgpO1xuICAgIGxvZ2dlci5lcnJvcihjaGFsay5yZWQoJ0VSUk9SOiBQcm9qZWN0IGRpcmVjdG9yeSBhbHJlYWR5IGV4aXN0cy4nKSk7XG4gICAgZXhpdCgxKTtcbiAgfVxuXG4gIGNwU3luYyhcbiAgICBwYXRoLmpvaW4oVEVNUF9ESVJfTkFNRSwgJ3BhbnRoZW9uLXNkaycsIFRFTVBMQVRFX0ZPTERFUl9NQVBbdGVtcGxhdGVdKSxcbiAgICBkaXJOYW1lLFxuICAgIHsgcmVjdXJzaXZlOiB0cnVlIH0sXG4gICk7XG4gIGNoZGlyKGRpck5hbWUpO1xuICBjb25zdCBwYWNrYWdlSnNvbiA9IEpTT04ucGFyc2UocmVhZEZpbGVTeW5jKCcuL3BhY2thZ2UuanNvbicpLnRvU3RyaW5nKCkpO1xuICBpZiAoYXBwTmFtZSkgcGFja2FnZUpzb24ubmFtZSA9IGFwcE5hbWU7XG4gIGVsc2UgcGFja2FnZUpzb24ubmFtZSA9IHBhdGgucGFyc2UoZGlyTmFtZSkuYmFzZTtcblxuICBpZiAoZXNsaW50KSB7XG4gICAgcGFja2FnZUpzb24uZGV2RGVwZW5kZW5jaWVzID0ge1xuICAgICAgLi4ucGFja2FnZUpzb24uZGV2RGVwZW5kZW5jaWVzLFxuICAgICAgLi4uRVNMSU5UX0RFUEVOREVOQ0lFUyxcbiAgICB9O1xuXG4gICAgd3JpdGVGaWxlU3luYygnLi8uZXNsaW50cmMuanNvbicsIEpTT04uc3RyaW5naWZ5KEVTTElOVF9DT05GSUcsIG51bGwsIDIpKTtcbiAgfVxuXG4gIHdyaXRlRmlsZVN5bmMoJy4vcGFja2FnZS5qc29uJywgSlNPTi5zdHJpbmdpZnkocGFja2FnZUpzb24sIG51bGwsIDIpICsgJ1xcbicpO1xuXG4gIC8vIENvbW1pdHRpbmcgY2hhbmdlcyB0byBHaXRcbiAgYXdhaXQgc2goJ2dpdCBpbml0Jyk7XG4gIGF3YWl0IHNoKCdnaXQgYWRkIC4nKTtcbiAgYXdhaXQgc2goXG4gICAgJ2dpdCBjb21taXQgLW0gXCJJbml0aWFsIGNvbW1pdCBmcm9tIFBhbnRoZW9uIENvbnRlbnQgQ2xvdWQgVG9vbGtpdC5cIicsXG4gICk7XG4gIHNldHVwUHJvai5zdWNjZWVkKCdDb21wbGV0ZWQgc2V0dGluZyB1cCBwcm9qZWN0IScpO1xuXG4gIGNvbnN0IGxvY2FsRW52RmlsZU5hbWUgPVxuICAgIHRlbXBsYXRlID09PSAnZ2F0c2J5JyA/ICcuZW52LmRldmVsb3BtZW50JyA6ICcuZW52LmxvY2FsJztcblxuICAvLyBDcmVhdGUgLmVudi5sb2NhbC8uZW52LmRldmVsb3BtZW50XG4gIGF3YWl0IHNoKGBjcCAuZW52LmV4YW1wbGUgJHtsb2NhbEVudkZpbGVOYW1lfWApO1xuXG4gIGlmICghc2tpcEluc3RhbGxhdGlvbikge1xuICAgIC8vIEluc3RhbGxpbmcgZGVwZW5kZW5jaWVzXG4gICAgY29uc3QgaW5zdGFsbFByb2ogPSBuZXcgU3Bpbm5lckxvZ2dlcihcbiAgICAgICdJbnN0YWxsaW5nIGRlcGVuZGVuY2llcy4uLicsXG4gICAgICBzaWxlbnRMb2dzLFxuICAgICk7XG4gICAgaW5zdGFsbFByb2ouc3RhcnQoKTtcbiAgICBhd2FpdCBzaChgJHtwYWNrYWdlTWFuYWdlcn0gaW5zdGFsbGApO1xuICAgIGluc3RhbGxQcm9qLnN1Y2NlZWQoJ0luc3RhbGxlZCBkZXBlbmRlbmNpZXMhJyk7XG4gIH1cblxuICAvLyBDbGVhbmluZyB1cFxuICBwcm9jZXNzLmNoZGlyKCcuLi8nKTtcbiAgcm1TeW5jKFRFTVBfRElSX05BTUUsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuXG4gIC8vIE1lc3NhZ2luZyB0byBnZXQgc3RhcnRlZFxuICBsb2dnZXIubG9nKCk7XG4gIGxvZ2dlci5sb2coXG4gICAgY2hhbGsuZ3JlZW4oXG4gICAgICBgVG8gZ2V0IHN0YXJ0ZWQgcGxlYXNlIHJlcGxhY2UgdGhlIHBsYWNlaG9sZGVycyBpbiAke2xvY2FsRW52RmlsZU5hbWV9YCxcbiAgICApLFxuICApO1xuICBsb2dnZXIubG9nKGNoYWxrLmdyZWVuKGAgICBjZCAke2Rpck5hbWV9YCkpO1xuICBsb2dnZXIubG9nKGNoYWxrLmdyZWVuKGAgICB2aW0gLmVudi5sb2NhbGApKTtcbiAgbG9nZ2VyLmxvZyhjaGFsay5ncmVlbignQW5kIHRoZW4gcnVuIHRoZSB3ZWJzaXRlJykpO1xuICBpZiAodGVtcGxhdGUgPT09ICduZXh0anMnKSBsb2dnZXIubG9nKGNoYWxrLmdyZWVuKCcgICB5YXJuIGRldicpKTtcbiAgZWxzZSBsb2dnZXIubG9nKGNoYWxrLmdyZWVuKCcgICB5YXJuIHN0YXJ0JykpO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZXJyb3JIYW5kbGVyPHtcbiAgZGlyTmFtZTogc3RyaW5nO1xuICB0ZW1wbGF0ZTogQ2xpVGVtcGxhdGVPcHRpb25zO1xuICBwYWNrYWdlTWFuYWdlcjogUGFja2FnZU1hbmFnZXI7XG4gIHNraXBJbnN0YWxsYXRpb246IGJvb2xlYW47XG4gIHNpbGVudExvZ3M6IGJvb2xlYW47XG4gIGVzbGludDogYm9vbGVhbjtcbiAgYXBwTmFtZT86IHN0cmluZztcbn0+KGluaXQpO1xuIiwiaW1wb3J0IGNoYWxrIGZyb20gJ2NoYWxrJztcbmltcG9ydCB7IGV4aXQgfSBmcm9tICdwcm9jZXNzJztcblxuZXhwb3J0IGNsYXNzIFVuaGFuZGxlZEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLm5hbWU7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFVzZXJOb3RMb2dnZWRJbiBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoJ1BsZWFlcyBsb2dpbiB1c2VyIHVzaW5nIGBwY2MgbG9naW5gIGNvbW1hbmQnKTtcbiAgICB0aGlzLm5hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLm5hbWU7XG4gIH1cbn1cbmV4cG9ydCBjbGFzcyBIVFRQTm90Rm91bmQgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCdOb3QgRm91bmQnKTtcbiAgICB0aGlzLm5hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLm5hbWU7XG4gIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBlcnJvckhhbmRsZXI8VD4oZjogKGFyZzogVCkgPT4gUHJvbWlzZTx2b2lkPikge1xuICByZXR1cm4gYXN5bmMgZnVuY3Rpb24gKGFyZzogVCkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBmKGFyZyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKGUgaW5zdGFuY2VvZiBVc2VyTm90TG9nZ2VkSW4pIHtcbiAgICAgICAgY29uc29sZS5sb2coY2hhbGsucmVkKCdFcnJvcjogVXNlciBpcyBub3QgbG9nZ2VkIGluLicpKTtcbiAgICAgICAgY29uc29sZS5sb2coY2hhbGsueWVsbG93KCdQbGVhc2UgcnVuIFwicGNjIGxvZ2luXCIgdG8gbG9naW4gdGhlIHVzZXIuJykpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgY2hhbGsueWVsbG93KCdcXG5TdGFjayB0cmFjZTonLCAoZSBhcyB7IHN0YWNrOiBzdHJpbmcgfSkuc3RhY2spLFxuICAgICAgICApO1xuICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICBjaGFsay5yZWQoXG4gICAgICAgICAgICAnRXJyb3I6IFNvbWV0aGluZyB3ZW50IHdyb25nLiBQbGVhc2UgY29udGFjdCBQYW50aGVvbiBzdXBwb3J0IHRlYW0uJyxcbiAgICAgICAgICApLFxuICAgICAgICApO1xuICAgICAgICBleGl0KDEpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cbiIsImltcG9ydCBvcmEsIHsgT3JhIH0gZnJvbSAnb3JhJztcbmV4cG9ydCBjbGFzcyBTcGlubmVyTG9nZ2VyIHtcbiAgbG9nZ2VyOiBPcmEgfCBudWxsO1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIGRpc2FibGVkOiBib29sZWFuID0gZmFsc2UpIHtcbiAgICBpZiAoIWRpc2FibGVkKSB0aGlzLmxvZ2dlciA9IG9yYShtZXNzYWdlKTtcbiAgICBlbHNlIHRoaXMubG9nZ2VyID0gbnVsbDtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIGlmICh0aGlzLmxvZ2dlcikgdGhpcy5sb2dnZXIuc3RhcnQoKTtcbiAgfVxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLmxvZ2dlcikgdGhpcy5sb2dnZXIuc3RvcCgpO1xuICB9XG5cbiAgc3VjY2VlZChtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICBpZiAodGhpcy5sb2dnZXIpIHRoaXMubG9nZ2VyLnN1Y2NlZWQobWVzc2FnZSk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIExvZ2dlciB7XG4gIGxvZ2dlcjogQ29uc29sZTtcbiAgZGlzYWJsZWQ6IGJvb2xlYW47XG4gIGNvbnN0cnVjdG9yKGRpc2FibGVkOiBib29sZWFuID0gZmFsc2UpIHtcbiAgICB0aGlzLmxvZ2dlciA9IGNvbnNvbGU7XG4gICAgdGhpcy5kaXNhYmxlZCA9IGRpc2FibGVkO1xuICB9XG5cbiAgbG9nKC4uLmFyZ3M6IGFueVtdKSB7XG4gICAgaWYgKCF0aGlzLmRpc2FibGVkKSB0aGlzLmxvZ2dlci5sb2coLi4uYXJncyk7XG4gIH1cbiAgZXJyb3IoLi4uYXJnczogYW55W10pIHtcbiAgICB0aGlzLmxvZ2dlci5lcnJvciguLi5hcmdzKTtcbiAgfVxufVxuIiwiaW1wb3J0IG9yYSBmcm9tICdvcmEnO1xuaW1wb3J0IEFkZE9uQXBpSGVscGVyIGZyb20gJy4uLy4uL2xpYi9hZGRvbkFwaUhlbHBlcic7XG5pbXBvcnQgY2hhbGsgZnJvbSAnY2hhbGsnO1xuaW1wb3J0IHsgcHJpbnRUYWJsZSB9IGZyb20gJy4uLy4uL2xpYi9jbGlEaXNwbGF5JztcbmltcG9ydCBkYXlqcyBmcm9tICdkYXlqcyc7XG5pbXBvcnQgeyBleGl0IH0gZnJvbSAncHJvY2Vzcyc7XG5pbXBvcnQgeyBIVFRQTm90Rm91bmQsIGVycm9ySGFuZGxlciB9IGZyb20gJy4uL2V4Y2VwdGlvbnMnO1xuXG5leHBvcnQgY29uc3QgY3JlYXRlVG9rZW4gPSBlcnJvckhhbmRsZXI8dm9pZD4oYXN5bmMgKCkgPT4ge1xuICBjb25zdCBzcGlubmVyID0gb3JhKCdDcmVhdGluZyB0b2tlbi4uLicpLnN0YXJ0KCk7XG4gIHRyeSB7XG4gICAgY29uc3QgYXBpS2V5ID0gYXdhaXQgQWRkT25BcGlIZWxwZXIuY3JlYXRlQXBpS2V5KCk7XG4gICAgc3Bpbm5lci5zdWNjZWVkKGBTdWNjZXNzZnVsbHkgY3JlYXRlZCB0b2tlbiBmb3IgeW91ciB1c2VyLiBgKTtcbiAgICBjb25zb2xlLmxvZygnXFxuVG9rZW46JywgY2hhbGsuYm9sZChjaGFsay5ncmVlbihhcGlLZXkpKSwgJ1xcbicpO1xuICAgIGNvbnNvbGUubG9nKFxuICAgICAgY2hhbGsuYm9sZChcbiAgICAgICAgY2hhbGsueWVsbG93KCdQbGVhc2Ugbm90ZSBpdCBkb3duLiBJdCB3b250IGJlIGFjY2Vzc2libGUgaGVyZWFmdGVyLicpLFxuICAgICAgKSxcbiAgICApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgc3Bpbm5lci5mYWlsKCk7XG4gICAgdGhyb3cgZTtcbiAgfVxufSk7XG5leHBvcnQgY29uc3QgbGlzdFRva2VucyA9IGVycm9ySGFuZGxlcjx2b2lkPihhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHNwaW5uZXIgPSBvcmEoJ0ZldGNoaW5nIGxpc3Qgb2YgZXhpc3RpbmcgdG9rZW5zLi4uJykuc3RhcnQoKTtcbiAgdHJ5IHtcbiAgICBjb25zdCBhcGlLZXlzID0gYXdhaXQgQWRkT25BcGlIZWxwZXIubGlzdEFwaUtleXMoKTtcblxuICAgIHNwaW5uZXIuc3VjY2VlZCgnU3VjY2Vzc2Z1bGx5IGZldGNoZWQgbGlzdCBvZiB0b2tlbnMuJyk7XG4gICAgaWYgKGFwaUtleXMubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zb2xlLmxvZyhjaGFsay55ZWxsb3coJ05vIHRva2VucyBmb3VuZC4nKSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgcHJpbnRUYWJsZShcbiAgICAgIGFwaUtleXMubWFwKChpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgSWQ6IGl0ZW0uaWQsXG4gICAgICAgICAgS2V5OiBpdGVtLmtleU1hc2tlZCxcbiAgICAgICAgICAnQ3JlYXRlZCBBdCc6IGRheWpzKGl0ZW0uY3JlYXRlZCkuZm9ybWF0KCdERCBNTU0gWVlZWSwgaGg6bW0gQScpLFxuICAgICAgICB9O1xuICAgICAgfSksXG4gICAgKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHNwaW5uZXIuZmFpbCgpO1xuICAgIHRocm93IGU7XG4gIH1cbn0pO1xuZXhwb3J0IGNvbnN0IHJldm9rZVRva2VuID0gZXJyb3JIYW5kbGVyPHN0cmluZz4oYXN5bmMgKGlkOiBzdHJpbmcpID0+IHtcbiAgY29uc3Qgc3Bpbm5lciA9IG9yYSgnUmV2b2tpbmcgdG9rZW4gZm9yIGdpdmVuIElELi4uJykuc3RhcnQoKTtcbiAgdHJ5IHtcbiAgICBhd2FpdCBBZGRPbkFwaUhlbHBlci5yZXZva2VBcGlLZXkoaWQpO1xuICAgIHNwaW5uZXIuc3VjY2VlZChcbiAgICAgIGBTdWNjZXNzZnVsbHkgcmV2b2tlZCB0b2tlbiBmb3IgSUQgXCIke2NoYWxrLmJvbGQoY2hhbGsueWVsbG93KGlkKSl9XCIhYCxcbiAgICApO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBzcGlubmVyLmZhaWwoKTtcbiAgICBpZiAoZXJyIGluc3RhbmNlb2YgSFRUUE5vdEZvdW5kKSB7XG4gICAgICBjb25zb2xlLmxvZyhjaGFsay5yZWQoJ1Rva2VuIGZvciBnaXZlbiBJRCBub3QgZm91bmQuJykpO1xuICAgICAgZXhpdCgxKTtcbiAgICB9XG4gICAgdGhyb3cgZXJyO1xuICB9XG59KTtcbiIsImltcG9ydCBheGlvcywgeyBIdHRwU3RhdHVzQ29kZSB9IGZyb20gJ2F4aW9zJztcbmltcG9ydCB7IGdldExvY2FsQXV0aERldGFpbHMgfSBmcm9tICcuL2xvY2FsU3RvcmFnZSc7XG5pbXBvcnQgeyBIVFRQTm90Rm91bmQsIFVzZXJOb3RMb2dnZWRJbiB9IGZyb20gJy4uL2NsaS9leGNlcHRpb25zJztcbmltcG9ydCBjb25maWcgZnJvbSAnLi9jb25maWcnO1xuaW1wb3J0IHsgQ3JlZGVudGlhbHMgfSBmcm9tICdnb29nbGUtYXV0aC1saWJyYXJ5JztcblxuY29uc3QgQVBJX0tFWV9FTkRQT0lOVCA9IGAke2NvbmZpZy5hZGRPbkFwaUVuZHBvaW50fS9hcGkta2V5YDtcbmNvbnN0IFNJVEVfRU5EUE9JTlQgPSBgJHtjb25maWcuYWRkT25BcGlFbmRwb2ludH0vc2l0ZXNgO1xuY29uc3QgT0FVVEhfRU5EUE9JTlQgPSBgJHtjb25maWcuYWRkT25BcGlFbmRwb2ludH0vb2F1dGhgO1xuXG5jbGFzcyBBZGRPbkFwaUhlbHBlciB7XG4gIHN0YXRpYyBhc3luYyBnZXRUb2tlbihjb2RlOiBzdHJpbmcpOiBQcm9taXNlPENyZWRlbnRpYWxzPiB7XG4gICAgY29uc3QgcmVzcCA9IGF3YWl0IGF4aW9zLnBvc3QoYCR7T0FVVEhfRU5EUE9JTlR9L3Rva2VuYCwge1xuICAgICAgY29kZTogY29kZSxcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzcC5kYXRhIGFzIENyZWRlbnRpYWxzO1xuICB9XG4gIHN0YXRpYyBhc3luYyByZWZyZXNoVG9rZW4ocmVmcmVzaFRva2VuOiBzdHJpbmcpOiBQcm9taXNlPENyZWRlbnRpYWxzPiB7XG4gICAgY29uc3QgcmVzcCA9IGF3YWl0IGF4aW9zLnBvc3QoYCR7T0FVVEhfRU5EUE9JTlR9L3JlZnJlc2hgLCB7XG4gICAgICByZWZyZXNoVG9rZW4sXG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3AuZGF0YSBhcyBDcmVkZW50aWFscztcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyBjcmVhdGVBcGlLZXkoKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBhdXRoRGV0YWlscyA9IGF3YWl0IGdldExvY2FsQXV0aERldGFpbHMoKTtcbiAgICBpZiAoIWF1dGhEZXRhaWxzKSB0aHJvdyBuZXcgVXNlck5vdExvZ2dlZEluKCk7XG5cbiAgICBjb25zdCByZXNwID0gYXdhaXQgYXhpb3MucG9zdChcbiAgICAgIEFQSV9LRVlfRU5EUE9JTlQsXG4gICAgICB7fSxcbiAgICAgIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHthdXRoRGV0YWlscy5pZF90b2tlbn1gLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICApO1xuICAgIHJldHVybiByZXNwLmRhdGEuYXBpS2V5IGFzIHN0cmluZztcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyBsaXN0QXBpS2V5cygpOiBQcm9taXNlPEFwaUtleVtdPiB7XG4gICAgY29uc3QgYXV0aERldGFpbHMgPSBhd2FpdCBnZXRMb2NhbEF1dGhEZXRhaWxzKCk7XG4gICAgaWYgKCFhdXRoRGV0YWlscykgdGhyb3cgbmV3IFVzZXJOb3RMb2dnZWRJbigpO1xuXG4gICAgY29uc3QgcmVzcCA9IGF3YWl0IGF4aW9zLmdldChBUElfS0VZX0VORFBPSU5ULCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHthdXRoRGV0YWlscy5pZF90b2tlbn1gLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIHJldHVybiByZXNwLmRhdGEgYXMgQXBpS2V5W107XG4gIH1cblxuICBzdGF0aWMgYXN5bmMgcmV2b2tlQXBpS2V5KGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBhdXRoRGV0YWlscyA9IGF3YWl0IGdldExvY2FsQXV0aERldGFpbHMoKTtcbiAgICBpZiAoIWF1dGhEZXRhaWxzKSB0aHJvdyBuZXcgVXNlck5vdExvZ2dlZEluKCk7XG5cbiAgICB0cnkge1xuICAgICAgYXdhaXQgYXhpb3MuZGVsZXRlKGAke0FQSV9LRVlfRU5EUE9JTlR9LyR7aWR9YCwge1xuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2F1dGhEZXRhaWxzLmlkX3Rva2VufWAsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGlmIChcbiAgICAgICAgKGVyciBhcyB7IHJlc3BvbnNlOiB7IHN0YXR1czogbnVtYmVyIH0gfSkucmVzcG9uc2Uuc3RhdHVzID09PVxuICAgICAgICBIdHRwU3RhdHVzQ29kZS5Ob3RGb3VuZFxuICAgICAgKVxuICAgICAgICB0aHJvdyBuZXcgSFRUUE5vdEZvdW5kKCk7XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIGFzeW5jIGNyZWF0ZVNpdGUodXJsOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGF1dGhEZXRhaWxzID0gYXdhaXQgZ2V0TG9jYWxBdXRoRGV0YWlscygpO1xuICAgIGlmICghYXV0aERldGFpbHMpIHRocm93IG5ldyBVc2VyTm90TG9nZ2VkSW4oKTtcblxuICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBheGlvcy5wb3N0KFxuICAgICAgU0lURV9FTkRQT0lOVCxcbiAgICAgIHsgbmFtZTogJycsIHVybCwgZW1haWxMaXN0OiAnJyB9LFxuICAgICAge1xuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2F1dGhEZXRhaWxzLmlkX3Rva2VufWAsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICk7XG4gICAgcmV0dXJuIHJlc3AuZGF0YS5pZCBhcyBzdHJpbmc7XG4gIH1cblxuICBzdGF0aWMgYXN5bmMgbGlzdFNpdGVzKCk6IFByb21pc2U8U2l0ZVtdPiB7XG4gICAgY29uc3QgYXV0aERldGFpbHMgPSBhd2FpdCBnZXRMb2NhbEF1dGhEZXRhaWxzKCk7XG4gICAgaWYgKCFhdXRoRGV0YWlscykgdGhyb3cgbmV3IFVzZXJOb3RMb2dnZWRJbigpO1xuXG4gICAgY29uc3QgcmVzcCA9IGF3YWl0IGF4aW9zLmdldChTSVRFX0VORFBPSU5ULCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHthdXRoRGV0YWlscy5pZF90b2tlbn1gLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIHJldHVybiByZXNwLmRhdGEgYXMgU2l0ZVtdO1xuICB9XG5cbiAgc3RhdGljIGFzeW5jIHVwZGF0ZVNpdGUoaWQ6IHN0cmluZywgdXJsOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBhdXRoRGV0YWlscyA9IGF3YWl0IGdldExvY2FsQXV0aERldGFpbHMoKTtcbiAgICBpZiAoIWF1dGhEZXRhaWxzKSB0aHJvdyBuZXcgVXNlck5vdExvZ2dlZEluKCk7XG5cbiAgICBhd2FpdCBheGlvcy5wYXRjaChcbiAgICAgIGAke1NJVEVfRU5EUE9JTlR9LyR7aWR9YCxcbiAgICAgIHsgdXJsIH0sXG4gICAgICB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7YXV0aERldGFpbHMuaWRfdG9rZW59YCxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBZGRPbkFwaUhlbHBlcjtcbiIsImltcG9ydCB7IHdyaXRlRmlsZVN5bmMsIHJlYWRGaWxlU3luYyB9IGZyb20gJ2ZzJztcbmltcG9ydCB7IGVuc3VyZUZpbGUgfSBmcm9tICdmcy1leHRyYSc7XG5pbXBvcnQgeyBQQ0NfUk9PVF9ESVIgfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgQ3JlZGVudGlhbHMgfSBmcm9tICdnb29nbGUtYXV0aC1saWJyYXJ5JztcbmltcG9ydCBBZGRPbkFwaUhlbHBlciBmcm9tICcuL2FkZG9uQXBpSGVscGVyJztcblxuZXhwb3J0IGNvbnN0IEFVVEhfRklMRV9QQVRIID0gYCR7UENDX1JPT1RfRElSfS9hdXRoLmpzb25gO1xuZXhwb3J0IGNvbnN0IGdldExvY2FsQXV0aERldGFpbHMgPSBhc3luYyAoKTogUHJvbWlzZTxDcmVkZW50aWFscyB8IG51bGw+ID0+IHtcbiAgbGV0IGNyZWRlbnRpYWxzOiBDcmVkZW50aWFscztcbiAgdHJ5IHtcbiAgICBjcmVkZW50aWFscyA9IEpTT04ucGFyc2UoXG4gICAgICByZWFkRmlsZVN5bmMoQVVUSF9GSUxFX1BBVEgpLnRvU3RyaW5nKCksXG4gICAgKSBhcyBDcmVkZW50aWFscztcbiAgfSBjYXRjaCAoX2Vycikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLy8gQ2hlY2sgaWYgdG9rZW4gaXMgZXhwaXJlZFxuICBpZiAoY3JlZGVudGlhbHMuZXhwaXJ5X2RhdGUgJiYgY3JlZGVudGlhbHMuZXhwaXJ5X2RhdGUgPiBEYXRlLm5vdygpKVxuICAgIHJldHVybiBjcmVkZW50aWFscztcblxuICB0cnkge1xuICAgIGNvbnN0IG5ld0NyZWQgPSBhd2FpdCBBZGRPbkFwaUhlbHBlci5yZWZyZXNoVG9rZW4oXG4gICAgICBjcmVkZW50aWFscy5yZWZyZXNoX3Rva2VuIGFzIHN0cmluZyxcbiAgICApO1xuICAgIHBlcnNpc3RBdXRoRGV0YWlscyhuZXdDcmVkKTtcbiAgICByZXR1cm4gbmV3Q3JlZDtcbiAgfSBjYXRjaCAoX2Vycikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgcGVyc2lzdEF1dGhEZXRhaWxzID0gYXN5bmMgKFxuICBwYXlsb2FkOiBDcmVkZW50aWFscyxcbik6IFByb21pc2U8dm9pZD4gPT4ge1xuICBhd2FpdCBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PlxuICAgIGVuc3VyZUZpbGUoQVVUSF9GSUxFX1BBVEgsIChlcnI6IGFueSkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUoKTtcbiAgICAgIH1cbiAgICB9KSxcbiAgKTtcblxuICB3cml0ZUZpbGVTeW5jKEFVVEhfRklMRV9QQVRILCBKU09OLnN0cmluZ2lmeShwYXlsb2FkLCBudWxsLCAyKSk7XG59O1xuIiwiaW1wb3J0IG9zIGZyb20gJ29zJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuXG5leHBvcnQgY29uc3QgUENDX1JPT1RfRElSID0gcGF0aC5qb2luKG9zLmhvbWVkaXIoKSwgJy5wY2MnKTtcbiIsImVudW0gRW52IHtcbiAgcHJvZHVjdGlvbiA9ICdwcm9kdWN0aW9uJyxcbiAgc3RhZ2luZyA9ICdzdGFnaW5nJyxcbn1cbnR5cGUgQ29uZmlnID0ge1xuICBhZGRPbkFwaUVuZHBvaW50OiBzdHJpbmc7XG4gIGdvb2dsZUNsaWVudElkOiBzdHJpbmc7XG4gIGdvb2dsZVJlZGlyZWN0VXJpOiBzdHJpbmc7XG59O1xuY29uc3QgRU5WOiBFbnYgPSAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgYXMgRW52KSB8fCAncHJvZHVjdGlvbic7XG5cbmNvbnN0IGNvbmZpZzogeyBba2V5IGluIEVudl06IENvbmZpZyB9ID0ge1xuICBbRW52LnByb2R1Y3Rpb25dOiB7XG4gICAgYWRkT25BcGlFbmRwb2ludDpcbiAgICAgICdodHRwczovL3VzLWNlbnRyYWwxLXBhbnRoZW9uLWNvbnRlbnQtY2xvdWQuY2xvdWRmdW5jdGlvbnMubmV0L2FkZE9uQXBpJyxcbiAgICBnb29nbGVDbGllbnRJZDpcbiAgICAgICc0MzI5OTg5NTI3NDktNmV1cm91YW1sdDdtdmFjYjZ1NGU5MTNtM2tnNDc3NGMuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20nLFxuICAgIGdvb2dsZVJlZGlyZWN0VXJpOiAnaHR0cDovL2xvY2FsaG9zdDozMDMwL29hdXRoLXJlZGlyZWN0JyxcbiAgfSxcbiAgW0Vudi5zdGFnaW5nXToge1xuICAgIGFkZE9uQXBpRW5kcG9pbnQ6XG4gICAgICAnaHR0cHM6Ly91cy1jZW50cmFsMS1wYW50aGVvbi1jb250ZW50LWNsb3VkLXN0YWdpbmcuY2xvdWRmdW5jdGlvbnMubmV0L2FkZE9uQXBpJyxcbiAgICBnb29nbGVDbGllbnRJZDpcbiAgICAgICcxNDI0NzAxOTE1NDEtOG8xNGo3N3B2YWdpc2M2NnM0OGtsNHViOTFmOWM3YjguYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20nLFxuICAgIGdvb2dsZVJlZGlyZWN0VXJpOiAnaHR0cDovL2xvY2FsaG9zdDozMDMwL29hdXRoLXJlZGlyZWN0JyxcbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNvbmZpZ1tFTlZdO1xuIiwiaW1wb3J0IHsgQ29uc29sZSB9IGZyb20gJ2NvbnNvbGUnO1xuaW1wb3J0IHsgVHJhbnNmb3JtIH0gZnJvbSAnc3RyZWFtJztcblxuZXhwb3J0IGZ1bmN0aW9uIHByaW50VGFibGUoaW5wdXQ6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIHwgbnVtYmVyIH1bXSkge1xuICBpZiAoaW5wdXQubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgLy8gQWRkaW5nIHNwYWNlIHBhZGRpbmcgYXQgdGhlIGVuZC4gY29uc29sZS50YWJsZSBkb2Vzbid0IGhhbmRsZSBpdCBvdXQgb2YgdGhlIGJveC5cbiAgY29uc3QgY29sdW1uUGFkZGluZ3MgPSBPYmplY3Qua2V5cyhpbnB1dFswXSkucmVkdWNlKFxuICAgIChwcmV2OiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB9LCBjdXJyKSA9PiB7XG4gICAgICBwcmV2W2N1cnJdID0gY3Vyci50b1N0cmluZygpLmxlbmd0aDtcbiAgICAgIHJldHVybiBwcmV2O1xuICAgIH0sXG4gICAge30sXG4gICk7XG4gIGlucHV0LmZvckVhY2goKHJvdykgPT4ge1xuICAgIE9iamVjdC5rZXlzKGNvbHVtblBhZGRpbmdzKS5mb3JFYWNoKChjb2x1bW4pID0+IHtcbiAgICAgIGlmIChyb3dbY29sdW1uXS50b1N0cmluZygpLmxlbmd0aCA+IGNvbHVtblBhZGRpbmdzW2NvbHVtbl0pXG4gICAgICAgIGNvbHVtblBhZGRpbmdzW2NvbHVtbl0gPSByb3dbY29sdW1uXS50b1N0cmluZygpLmxlbmd0aDtcbiAgICB9KTtcbiAgfSk7XG5cbiAgY29uc3QgaW5wdXRXaXRoUGFkZGluZ3M6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIHwgbnVtYmVyIH1bXSA9IFtdO1xuICBpbnB1dC5mb3JFYWNoKChyb3cpID0+IHtcbiAgICBpbnB1dFdpdGhQYWRkaW5ncy5wdXNoKFxuICAgICAgT2JqZWN0LmtleXMoY29sdW1uUGFkZGluZ3MpLnJlZHVjZShcbiAgICAgICAgKHByZXY6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0sIGN1cnIpID0+IHtcbiAgICAgICAgICBwcmV2W2N1cnJdID0gcm93W2N1cnJdLnRvU3RyaW5nKCkucGFkRW5kKGNvbHVtblBhZGRpbmdzW2N1cnJdKTtcbiAgICAgICAgICByZXR1cm4gcHJldjtcbiAgICAgICAgfSxcbiAgICAgICAge30sXG4gICAgICApLFxuICAgICk7XG4gIH0pO1xuXG4gIC8vIFN0YXJ0aW5nIGZvcm1hdHRpbmcgaW5wdXQgaW50byB0YWJsZVxuICBjb25zdCB0cyA9IG5ldyBUcmFuc2Zvcm0oe1xuICAgIHRyYW5zZm9ybShjaHVuaywgZW5jLCBjYikge1xuICAgICAgY2IobnVsbCwgY2h1bmspO1xuICAgIH0sXG4gIH0pO1xuICBjb25zdCBsb2dnZXIgPSBuZXcgQ29uc29sZSh7IHN0ZG91dDogdHMgfSk7XG4gIGxvZ2dlci50YWJsZShpbnB1dFdpdGhQYWRkaW5ncyk7XG4gIGNvbnN0IHRhYmxlID0gKHRzLnJlYWQoKSB8fCAnJykudG9TdHJpbmcoKTtcbiAgbGV0IHJlc3VsdCA9ICcnO1xuICBmb3IgKGxldCByb3cgb2YgdGFibGUuc3BsaXQoL1tcXHJcXG5dKy8pKSB7XG4gICAgbGV0IHIgPSByb3cucmVwbGFjZSgvW17ilKxdKuKUrC8sICfilIwnKTtcbiAgICByID0gci5yZXBsYWNlKC9e4pSc4pSAKuKUvC8sICfilJwnKTtcbiAgICByID0gci5yZXBsYWNlKC/ilIJbXuKUgl0qLywgJycpO1xuICAgIHIgPSByLnJlcGxhY2UoL17ilJTilIAq4pS0LywgJ+KUlCcpO1xuICAgIHIgPSByLnJlcGxhY2UoLycvZywgJyAnKTtcbiAgICByZXN1bHQgKz0gYCR7cn1cXG5gO1xuICB9XG4gIGNvbnNvbGUubG9nKHJlc3VsdCk7XG59XG4iLCJpbXBvcnQgeyBPQXV0aDJDbGllbnQgfSBmcm9tICdnb29nbGUtYXV0aC1saWJyYXJ5JztcbmltcG9ydCBodHRwIGZyb20gJ2h0dHAnO1xuaW1wb3J0IHVybCBmcm9tICd1cmwnO1xuaW1wb3J0IHsgZmlsZVVSTFRvUGF0aCB9IGZyb20gJ3VybCc7XG5pbXBvcnQgeyBkaXJuYW1lLCBqb2luIH0gZnJvbSAncGF0aCc7XG5pbXBvcnQgb3BlbiBmcm9tICdvcGVuJztcbmltcG9ydCBkZXN0cm95ZXIgZnJvbSAnc2VydmVyLWRlc3Ryb3knO1xuaW1wb3J0IHsgcmVhZEZpbGVTeW5jIH0gZnJvbSAnZnMnO1xuaW1wb3J0IG51bmp1Y2tzIGZyb20gJ251bmp1Y2tzJztcbm51bmp1Y2tzLmNvbmZpZ3VyZSh7IGF1dG9lc2NhcGU6IHRydWUgfSk7XG5cbmNvbnN0IE9BVVRIX1NDT1BFUyA9IFsnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC91c2VyaW5mby5lbWFpbCddO1xuXG5pbXBvcnQgQWRkT25BcGlIZWxwZXIgZnJvbSAnLi4vLi4vbGliL2FkZG9uQXBpSGVscGVyJztcbmltcG9ydCBvcmEgZnJvbSAnb3JhJztcbmltcG9ydCB7XG4gIGdldExvY2FsQXV0aERldGFpbHMsXG4gIHBlcnNpc3RBdXRoRGV0YWlscyxcbn0gZnJvbSAnLi4vLi4vbGliL2xvY2FsU3RvcmFnZSc7XG5pbXBvcnQgeyBwYXJzZUp3dCB9IGZyb20gJy4uLy4uL2xpYi9qd3QnO1xuaW1wb3J0IHsgZXJyb3JIYW5kbGVyIH0gZnJvbSAnLi4vZXhjZXB0aW9ucyc7XG5pbXBvcnQgY29uZmlnIGZyb20gJy4uLy4uL2xpYi9jb25maWcnO1xuXG5mdW5jdGlvbiBsb2dpbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBzcGlubmVyID0gb3JhKCdMb2dnaW5nIHlvdSBpbi4uLicpLnN0YXJ0KCk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGF1dGhEYXRhID0gYXdhaXQgZ2V0TG9jYWxBdXRoRGV0YWlscygpO1xuICAgICAgaWYgKGF1dGhEYXRhKSB7XG4gICAgICAgIGNvbnN0IGp3dFBheWxvYWQgPSBwYXJzZUp3dChhdXRoRGF0YS5pZF90b2tlbiBhcyBzdHJpbmcpO1xuICAgICAgICBzcGlubmVyLnN1Y2NlZWQoYFlvdSBhcmUgYWxyZWFkeSBsb2dnZWQgaW4gYXMgJHtqd3RQYXlsb2FkLmVtYWlsfS5gKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBvQXV0aDJDbGllbnQgPSBuZXcgT0F1dGgyQ2xpZW50KHtcbiAgICAgICAgY2xpZW50SWQ6IGNvbmZpZy5nb29nbGVDbGllbnRJZCxcbiAgICAgICAgcmVkaXJlY3RVcmk6IGNvbmZpZy5nb29nbGVSZWRpcmVjdFVyaSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBHZW5lcmF0ZSB0aGUgdXJsIHRoYXQgd2lsbCBiZSB1c2VkIGZvciB0aGUgY29uc2VudCBkaWFsb2cuXG4gICAgICBjb25zdCBhdXRob3JpemVVcmwgPSBvQXV0aDJDbGllbnQuZ2VuZXJhdGVBdXRoVXJsKHtcbiAgICAgICAgYWNjZXNzX3R5cGU6ICdvZmZsaW5lJyxcbiAgICAgICAgc2NvcGU6IE9BVVRIX1NDT1BFUyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzZXJ2ZXIgPSBodHRwXG4gICAgICAgIC5jcmVhdGVTZXJ2ZXIoYXN5bmMgKHJlcTogYW55LCByZXMpID0+IHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHJlcS51cmwuaW5kZXhPZignL29hdXRoLXJlZGlyZWN0JykgPiAtMSkge1xuICAgICAgICAgICAgICBjb25zdCBxcyA9IG5ldyB1cmwuVVJMKHJlcS51cmwsICdodHRwOi8vbG9jYWxob3N0OjMwMzAnKVxuICAgICAgICAgICAgICAgIC5zZWFyY2hQYXJhbXM7XG4gICAgICAgICAgICAgIGNvbnN0IGNvZGUgPSBxcy5nZXQoJ2NvZGUnKTtcbiAgICAgICAgICAgICAgY29uc3QgY3VyckRpciA9IGRpcm5hbWUoZmlsZVVSTFRvUGF0aChpbXBvcnQubWV0YS51cmwpKTtcbiAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IHJlYWRGaWxlU3luYyhcbiAgICAgICAgICAgICAgICBqb2luKGN1cnJEaXIsICcuLi90ZW1wbGF0ZXMvbG9naW5TdWNjZXNzLmh0bWwnKSxcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgY29uc3QgY3JlZGVudGlhbHMgPSBhd2FpdCBBZGRPbkFwaUhlbHBlci5nZXRUb2tlbihjb2RlIGFzIHN0cmluZyk7XG4gICAgICAgICAgICAgIGNvbnN0IGp3dFBheWxvYWQgPSBwYXJzZUp3dChjcmVkZW50aWFscy5pZF90b2tlbiBhcyBzdHJpbmcpO1xuICAgICAgICAgICAgICBhd2FpdCBwZXJzaXN0QXV0aERldGFpbHMoY3JlZGVudGlhbHMpO1xuXG4gICAgICAgICAgICAgIHJlcy5lbmQoXG4gICAgICAgICAgICAgICAgbnVuanVja3MucmVuZGVyU3RyaW5nKGNvbnRlbnQudG9TdHJpbmcoKSwge1xuICAgICAgICAgICAgICAgICAgZW1haWw6IGp3dFBheWxvYWQuZW1haWwsXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIHNlcnZlci5kZXN0cm95KCk7XG5cbiAgICAgICAgICAgICAgc3Bpbm5lci5zdWNjZWVkKFxuICAgICAgICAgICAgICAgIGBZb3UgYXJlIHN1Y2Nlc3NmdWxseSBsb2dnZWQgaW4gYXMgJHtqd3RQYXlsb2FkLmVtYWlsfWAsXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBzcGlubmVyLmZhaWwoKTtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5saXN0ZW4oMzAzMCwgKCkgPT4ge1xuICAgICAgICAgIG9wZW4oYXV0aG9yaXplVXJsLCB7IHdhaXQ6IHRydWUgfSkudGhlbigoY3ApID0+IGNwLmtpbGwoKSk7XG4gICAgICAgIH0pO1xuICAgICAgZGVzdHJveWVyKHNlcnZlcik7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgc3Bpbm5lci5mYWlsKCk7XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgfSk7XG59XG5leHBvcnQgZGVmYXVsdCBlcnJvckhhbmRsZXI8dm9pZD4obG9naW4pO1xuIiwiZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSnd0KHRva2VuOiBzdHJpbmcpIHtcbiAgcmV0dXJuIEpTT04ucGFyc2UoQnVmZmVyLmZyb20odG9rZW4uc3BsaXQoJy4nKVsxXSwgJ2Jhc2U2NCcpLnRvU3RyaW5nKCkpO1xufVxuIiwiaW1wb3J0IG9yYSBmcm9tICdvcmEnO1xuaW1wb3J0IHsgcm1TeW5jLCBleGlzdHNTeW5jIH0gZnJvbSAnZnMnO1xuaW1wb3J0IHsgQVVUSF9GSUxFX1BBVEggfSBmcm9tICcuLi8uLi9saWIvbG9jYWxTdG9yYWdlJztcbmltcG9ydCB7IGVycm9ySGFuZGxlciB9IGZyb20gJy4uL2V4Y2VwdGlvbnMnO1xuXG5jb25zdCBsb2dvdXQgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHNwaW5uZXIgPSBvcmEoJ0xvZ2dpbmcgeW91IG91dC4uLicpLnN0YXJ0KCk7XG4gIHRyeSB7XG4gICAgaWYgKGV4aXN0c1N5bmMoQVVUSF9GSUxFX1BBVEgpKSBybVN5bmMoQVVUSF9GSUxFX1BBVEgpO1xuICAgIHNwaW5uZXIuc3VjY2VlZCgnU3VjY2Vzc2Z1bGx5IGxvZ2dlZCB5b3Ugb3V0IGZyb20gUFBDIGNsaWVudCEnKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHNwaW5uZXIuZmFpbCgpO1xuICAgIHRocm93IGU7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IGVycm9ySGFuZGxlcjx2b2lkPihsb2dvdXQpO1xuIiwiaW1wb3J0IG9yYSBmcm9tICdvcmEnO1xuaW1wb3J0IEFkZE9uQXBpSGVscGVyIGZyb20gJy4uLy4uL2xpYi9hZGRvbkFwaUhlbHBlcic7XG5pbXBvcnQgY2hhbGsgZnJvbSAnY2hhbGsnO1xuaW1wb3J0IHsgcHJpbnRUYWJsZSB9IGZyb20gJy4uLy4uL2xpYi9jbGlEaXNwbGF5JztcbmltcG9ydCB7IGVycm9ySGFuZGxlciB9IGZyb20gJy4uL2V4Y2VwdGlvbnMnO1xuaW1wb3J0IGRheWpzIGZyb20gJ2RheWpzJztcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVNpdGUgPSBlcnJvckhhbmRsZXI8c3RyaW5nPihhc3luYyAodXJsOiBzdHJpbmcpID0+IHtcbiAgY29uc3Qgc3Bpbm5lciA9IG9yYSgnQ3JlYXRpbmcgc2l0ZS4uLicpLnN0YXJ0KCk7XG4gIHRyeSB7XG4gICAgYXdhaXQgQWRkT25BcGlIZWxwZXIuY3JlYXRlU2l0ZSh1cmwpO1xuICAgIHNwaW5uZXIuc3VjY2VlZChgU3VjY2Vzc2Z1bGx5IGNyZWF0ZWQgdGhlIHNpdGUgd2l0aCBnaXZlbiBkZXRhaWxzLmApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgc3Bpbm5lci5mYWlsKCk7XG4gICAgdGhyb3cgZTtcbiAgfVxufSk7XG5cbmV4cG9ydCBjb25zdCB1cGRhdGVTaXRlID0gZXJyb3JIYW5kbGVyPHtcbiAgaWQ6IHN0cmluZztcbiAgdXJsOiBzdHJpbmc7XG59Pihhc3luYyAoeyBpZCwgdXJsIH06IHsgaWQ6IHN0cmluZzsgdXJsOiBzdHJpbmcgfSkgPT4ge1xuICBjb25zdCBzcGlubmVyID0gb3JhKCdVcGRhdGluZyBzaXRlLi4uJykuc3RhcnQoKTtcbiAgdHJ5IHtcbiAgICBhd2FpdCBBZGRPbkFwaUhlbHBlci51cGRhdGVTaXRlKGlkLCB1cmwpO1xuICAgIHNwaW5uZXIuc3VjY2VlZChgU3VjY2Vzc2Z1bGx5IHVwZGF0ZWQgdGhlIHNpdGUgZm9yIGdpdmVuIElELmApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgc3Bpbm5lci5mYWlsKCk7XG4gICAgdGhyb3cgZTtcbiAgfVxufSk7XG5cbmV4cG9ydCBjb25zdCBsaXN0U2l0ZXMgPSBlcnJvckhhbmRsZXI8dm9pZD4oYXN5bmMgKCkgPT4ge1xuICBjb25zdCBzcGlubmVyID0gb3JhKCdGZXRjaGluZyBsaXN0IG9mIGV4aXN0aW5nIHNpdGVzLi4uJykuc3RhcnQoKTtcbiAgdHJ5IHtcbiAgICBjb25zdCBzaXRlcyA9IGF3YWl0IEFkZE9uQXBpSGVscGVyLmxpc3RTaXRlcygpO1xuXG4gICAgc3Bpbm5lci5zdWNjZWVkKCdTdWNjZXNzZnVsbHkgZmV0Y2hlZCBsaXN0IG9mIHNpdGVzLicpO1xuICAgIGlmIChzaXRlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKGNoYWxrLnllbGxvdygnTm8gc2l0ZXMgZm91bmQuJykpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHByaW50VGFibGUoXG4gICAgICBzaXRlcy5tYXAoKGl0ZW0pID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBJZDogaXRlbS5pZCxcbiAgICAgICAgICBVcmw6IGl0ZW0udXJsLFxuICAgICAgICAgICdDcmVhdGVkIEF0JzogaXRlbS5jcmVhdGVkXG4gICAgICAgICAgICA/IGRheWpzKGl0ZW0uY3JlYXRlZCkuZm9ybWF0KCdERCBNTU0gWVlZWSwgaGg6bW0gQScpXG4gICAgICAgICAgICA6ICdOQScsXG4gICAgICAgIH07XG4gICAgICB9KSxcbiAgICApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgc3Bpbm5lci5mYWlsKCk7XG4gICAgdGhyb3cgZTtcbiAgfVxufSk7XG4iXX0=